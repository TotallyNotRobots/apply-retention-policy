# The MIT License (MIT)
#
# Copyright Â© 2025 linuxdaemon <linuxdaemon.irc@gmail.com>
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
# THE SOFTWARE.

version: "2"

run:
  concurrency: 4
  timeout: 5m

linters:
  default: all
  disable:
    - depguard
    - err113
    - exhaustruct
    - funlen
    - gochecknoinits
    - godot
    - ireturn
    - mnd
    - nlreturn
    - noinlineerr
    - paralleltest
    - tagliatelle
    - testifylint
    - testpackage
    - thelper
    - tparallel
    - varnamelen
    - wrapcheck
    - wsl
  settings:
    errorlint:
      errorf: true
      errorf-multi: true
      asserts: true
      comparison: true
    asasalint:
      use-builtin-exclusions: true
    copyloopvar:
      check-alias: false
    goconst:
      min-len: 2
      min-occurrences: 3
    gocritic:
      enable-all: true
    inamedparam:
      skip-single-param: false
    gocyclo:
      min-complexity: 10
    unused:
      field-writes-are-uses: true
      post-statements-are-reads: false
      exported-fields-are-used: false
      parameters-are-used: true
      local-variables-are-used: true
      generated-is-used: true
    forbidigo:
      exclude-godoc-examples: true
      analyze-types: true
    govet:
      enable-all: true
      disable:
        - fieldalignment
    revive:
      enable-all-rules: true
      rules:
        - name: add-constant
          disabled: true
        - name: unused-receiver
          disabled: true
        - name: deep-exit
          disabled: true
        - name: unused-parameter
          disabled: true
        - name: function-length
          disabled: true
        - name: flag-parameter
          disabled: true
        - name: cognitive-complexity
          arguments:
            - 16
        - name: cyclomatic
          arguments:
            - 10
        - name: line-length-limit
          arguments:
            - 100
    staticcheck:
      checks:
        - all
  exclusions:
    warn-unused: true
    generated: strict
    rules:
      - path: _test.go
        linters:
          - gosec
      - path: cmd/root.go
        linters:
          - gochecknoglobals
          - lll
        text: "rootCmd|cfgFile"
      - path: cmd/prune.go
        linters:
          - gochecknoglobals
        text: "pruneCmd"
      - path: internal/retention/policy.go
        linters:
          - gochecknoglobals
        text: "hourGrouper|dayGrouper|weekGrouper|monthGrouper|yearGrouper"

formatters:
  enable:
    - gofmt
    - gofumpt
    - goimports
    - golines
    - swaggo
  settings:
    gofmt:
      simplify: true
    gofumpt:
      extra-rules: true
    goimports:
      local-prefixes:
        - "github.com/TotallyNotRobots/apply-retention-policy"
    golines:
      max-len: 100
      tab-len: 4
      shorten-comments: true
      reformat-tags: true
      chain-split-dots: true

  exclusions:
    warn-unused: true
    generated: strict

issues:
  max-issues-per-linter: 0
  max-same-issues: 0
  uniq-by-line: false

output:
  formats:
    text:
      path: stdout
      print-linter-name: true
      print-issued-lines: true
      colors: true
  path-prefix: ""
  path-mode: "abs"
  sort-order:
    - linter
    - severity
    - file
  show-stats: false
